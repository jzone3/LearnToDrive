typeof gm=="undefined"&&(gm={}),gm.appmanager={},gm.appmanager._focusSubscriptions={},gm.appmanager.requestFocus=function(a,b){var c=Emulator.checkArgs(arguments,[{name:"success",type:"function",required:!0},{name:"failure",type:"function",required:!1,"default":function(){}}]);a=c[0],b=c[1];var d=Emulator.getRequestingApp();d?Emulator.PubSub.notify(GM_CONFIG.Events.FOCUS_APP,{success:a,failure:b,appID:d}):b.call(this)},gm.appmanager.releaseFocus=function(a,b){var c=Emulator.checkArgs(arguments,[{name:"success",type:"function",required:!0},{name:"failure",type:"function",required:!1,"default":function(){}}]);Emulator.PubSub.notify(GM_CONFIG.Events.FOCUS_APP,{success:a,failure:b,appID:Emulator.HOME_SCREEN_ID})},gm.appmanager.closeApp=function(a){var b=Emulator.checkArgs(arguments,[{name:"failure",type:"function",required:!1,"default":function(){}}]);a=b[0];var c=Emulator.getRequestingApp();c?Emulator.PubSub.notify(GM_CONFIG.Events.CLOSE_APP,{success:function(){},failure:a,appID:c,type:GM_CONFIG.Shutdown.USER}):a&&a.call(this,arguments)},gm.appmanager.setShutdown=function(a,b){var c=Emulator.checkArgs(arguments,[{name:"success",type:"function",required:!0},{name:"failure",type:"function",required:!1,"default":function(){}}]);a=c[0],b=c[1];try{var d=Emulator.getRequestingApp();if(d){var e=GM_CONFIG.Communication.SHUTDOWN_WATCH_PREFIX+d;Emulator.PubSub.publish(e);var f=Emulator.PubSub.subscribe(e,function(b){try{a(b.type)}catch(c){console.error(c)}});return f}b.call()}catch(g){b(g)}},gm.appmanager.changeFriendlyName=function(a,b){Emulator.PubSub.notify(GM_CONFIG.Events.CHANGE_APP_NAME,{name:a,failure:b})},gm.appmanager.getMyVersion=function(){var a=Emulator.getRequestingApp();return Emulator.apps[a].config.AppVersion},gm.appmanager.getAccessToken=function(a,b){var c=Emulator.checkArgs(arguments,[{name:"success",required:!0,type:"function"},{name:"failure",required:!1,type:"function","default":function(){}}]),d=gm.hmi.getUser();d!=null?a(d):b(GM_CONFIG.FailureCodes.UNKNOWN)},gm.appmanager.launchApp=function(a,b,c){Emulator.checkTrustedApp();var d=Emulator.checkArgs(arguments,[{name:"success",required:!0,type:"function"},{name:"failure",required:!1,type:"function","default":function(){}},{name:"appID",required:!0,type:"number"}]);a=d[0],b=d[1],c=d[2],Emulator.PubSub.notify(GM_CONFIG.Events.LAUNCH_APP,{success:a,failure:b,appID:c})},gm.appmanager.deleteApp=function(a,b,c,d){Emulator.checkTrustedApp();var e=Emulator.checkArgs(arguments,[{name:"success",type:"function",required:!0},{name:"failure",type:"function",required:!1,"default":function(){}},{name:"appID",type:"number",required:!0}]);b=e[1],Emulator.PubSub.notify(GM_CONFIG.Events.DELETE_APP,{success:a,failure:b,appID:c,options:d})},gm.appmanager.removeAppRecord=function(a,b,c){Emulator.checkTrustedApp();var d=Emulator.checkArgs(arguments,[{name:"success",type:"function",required:!0},{name:"failure",type:"function",required:!1,"default":function(){}},{name:"appID",type:"number",required:!0}]);b=d[1];if(typeof Emulator.apps[c]!="undefined"){b(GM_CONFIG.FailureCodes.UNKNOWN);return}console.warn("removeAppRecord has no effect in the emulator."),a()},gm.appmanager.getBaseServerURL=function(a,b){Emulator.checkTrustedApp();var c=Emulator.checkArgs(arguments,[{name:"success",type:"function",required:!0},{name:"failure",type:"function",required:!1,"default":function(){}}]);a(Emulator.getValue(GM_CONFIG.ModelKeys.Communication.BaseServerURL))},gm.appmanager.killApp=function(a,b,c){Emulator.checkTrustedApp(),Emulator.PubSub.notify(GM_CONFIG.Events.CLOSE_APP,{success:a,failure:b,appID:c,type:GM_CONFIG.Shutdown.BUS})},gm.appmanager.addApp=function(a,b,c){Emulator.checkTrustedApp(),Emulator.checkArgs(arguments,[{name:"success",type:"function",required:!0},{name:"failure",type:"function",required:!1,"default":function(){}},{name:"path",type:"string",required:!0}]);var d=Emulator.loadApp(c,function(b){Emulator.homeScreenController.view.render(Emulator.apps),a.call(this,{appID:b.appID})},b);return d},gm.appmanager.synchronize=function(a,b){Emulator.checkTrustedApp(),Emulator.checkArgs(arguments,[{name:"success",type:"function",required:!1},{name:"failure",type:"function",required:!1,"default":function(){}}]),console.warn("The synchronize function was called correctly, but synchronization is not supported by the emulator"),a.call()},gm.appmanager.setSynchronizationPeriodicity=function(a,b,c){Emulator.checkTrustedApp(),Emulator.checkArgs(arguments,[{name:"success",type:"function",required:!1},{name:"failure",type:"function",required:!1,"default":function(){}},{name:"periodicity",type:"number",required:!0}]);var d=GM_CONFIG.SyncPeriods;for(var e in d)if(d[e]==c){Emulator.setValue(GM_CONFIG.ModelKeys.Sync.Periodicity,c),console.warn("The setSynchronizationPeriodicity function was stored successfully, but the emulator does not support synchronization."),a();return}typeof b=="function"&&b(GM_CONFIG.FailureCodes.UNKNOWN)},gm.appmanager.getSynchronizationPeriodicity=function(){return Emulator.checkTrustedApp(),Emulator.getValue(GM_CONFIG.ModelKeys.Sync.Periodicity)},gm.appmanager.setAutostart=function(a,b){Emulator.checkTrustedApp(),Emulator.checkArgs(arguments,[{name:"appID",type:"number",required:!0},{name:"value",type:"number",required:!0}]);if(Emulator.apps[a]==undefined||0>b>2)return!1;switch(b){case 0:Emulator.apps[a].config.AutoStart="false";break;case 1:Emulator.apps[a].config.AutoStart="true";break;case 2:var c=Emulator.apps[a].config.AutoStart;Emulator.apps[a].config.AutoStart=c=="false"?"true":"false"}return!0},gm.appmanager.addUserToApp=function(a,b,c){return Emulator.checkTrustedApp(),Emulator.checkArgs(arguments,[{name:"appID",type:"number",required:!0},{name:"username",type:"string",required:!0},{name:"options",type:"object",required:!1,"default":{}}]),typeof Emulator.apps[a]=="undefined"?2:(console.warn("The addUserToApp function was called correctly. This functionality is not supported by the emulator."),0)},gm.appmanager.watchFocus=function(a,b){var c=Emulator.checkArgs(arguments,[{name:"success",type:"function",required:!0},{name:"failure",type:"function",required:!1,"default":function(){}}]),d=Emulator.getRequestingApp(),e=Math.round(1e7*Math.random());return gm.appmanager._focusSubscriptions[e]={appID:d,callback:a},d==Emulator.getVisibleAppID()?a(GM_CONFIG.FocusStates.FOREGROUND):a(GM_CONFIG.FocusStates.BACKGROUND),e},gm.appmanager.clearFocus=function(a){var b=Emulator.checkArgs(arguments,[{name:"watchID",type:"number",required:!0}]),c=Emulator.getRequestingApp();return gm.appmanager._focusSubscriptions[a]?(delete gm.appmanager._focusSubscriptions[a],!0):!1},gm.appmanager.getAppsList=function(a){Emulator.checkTrustedApp();var b=Emulator.checkArgs(arguments,[{name:"options",type:"object",required:!1,"default":{}}]);a=b[0];var c=[];if(a.appID&&typeof Emulator.apps[a.appID]!="undefined"){var d=Emulator.apps[a.appID].parseAppInfo();return[d]}for(var e in Emulator.apps){var f=Emulator.apps[e].config;if(typeof a.requestedBy!="undefined"&&f.RequestedBy!=a.requestedBy)continue;if(typeof a.status!="undefined"&&a.status!=GM_CONFIG.FILTER.ANY&&a.status!=Emulator.getApplicationStatus(e))continue;if(typeof a.updateAvailable!="undefined"&&a.updateAvailable!=GM_CONFIG.FILTER.ANY&&f.updateAvailable.toString().toLowerCase()!=a.updateAvailable.toString().toLowerCase())continue;if(typeof a.lastUpdate!="undefined"&&f.lastUpdate.toString().toLowerCase()!=a.lastUpdate.toString().toLowerCase())continue;if(typeof a.running!="undefined"&&a.running==1&&Emulator.isAppRunning(e)===!1)continue;if(typeof a.state!="undefined"&&Emulator.apps[e].appInfo.state!=a.state)continue;var g=Emulator.apps[e].parseAppInfo();c.push(g)}return c},gm.appmanager.watchAppsInfo=function(a,b,c){Emulator.checkTrustedApp();var d=Emulator.checkArgs(arguments,[,{name:"success",type:"function",required:!0},{name:"failure",type:"function",required:!1,"default":function(){}},{name:"options",type:"object",required:!1,"default":{},contents:{requestedBy:{type:"string",required:!1},status:{type:"string",required:!1},updateAvailable:{type:"string",required:!1},lastUpdate:{type:"string",required:!1},authToken:{type:"string",required:!1},appID:{type:"number",required:!1},state:{type:"number",required:!1},running:{type:"boolean",required:!1}}}]);c=d[2];var e=Emulator.PubSub.subscribe(GM_CONFIG.Events.APP_INFO_CHANGE,function(b){var d=b.appInfo;if(Object.keys(d).length==0)a(d);else{d.running=Emulator.isAppRunning(d.appID),typeof c.updateAvailable=="string"&&(c.updateAvailable.toLowerCase()=="true"||c.updateAvailable==1?c.updateAvailable=!0:c.updateAvailable.toLowerCase()=="false"||c.updateAvailable==0?c.updateAvailable=!1:delete c.updateAvailable);for(var e in c)if(typeof c[e]!="undefined"&&c[e]!=d[e])return;a(d)}});return e},gm.appmanager.clearAppsInfo=function(a){Emulator.checkTrustedApp(),Emulator.PubSub.unsubscribe(GM_CONFIG.Events.APP_INFO_CHANGE,a)},gm.appmanager.setUpdateAvailable=function(a,b){Emulator.checkTrustedApp();if(typeof a!="number"||typeof b!="boolean")return GM_CONFIG.FailureCodes.INVALID_INPUT_PARAMS;var c=Emulator.apps[a];if(typeof c=="undefined")return 4;var d=c.get("updateAvailable");if(b==1)return d==1?3:(c.set("updateAvailable",!0),1);if(b==0)return d==0?2:(c.set("updateAvailable",!1),0)},gm.audio={},gm.audio.play=function(a,b,c){Emulator.checkArgs(arguments,[{name:"filename",required:!0,type:"string"},{name:"channel",required:!0,type:"string"},{name:"failure",required:!1,type:"function","default":function(){}}]),typeof c!="function"&&(c=function(){});var d=Emulator.mediaPlayerController.getNewAudioHandle(),e=Emulator.getRequestingApp();return Emulator.PubSub.notify(GM_CONFIG.Events.PLAY_AUDIO,{handle:d,filename:a,failure:c,appID:e,channel:b}),d},gm.audio.pause=function(a){Emulator.checkArgs(arguments,[{name:"AudioHandle",required:!0,type:"number"}]),Emulator.PubSub.notify(GM_CONFIG.Events.PAUSE_AUDIO,{handle:a})},gm.audio.stop=function(a){Emulator.checkArgs(arguments,[{name:"AudioHandle",required:!0,type:"number"}]);var b=Emulator.getRequestingApp();Emulator.PubSub.notify(GM_CONFIG.Events.STOP_AUDIO,{handle:a,appID:b})},gm.audio.seek=function(a,b){Emulator.checkArgs(arguments,[{name:"AudioHandle",required:!0,type:"number"},{name:"Position",required:!0,type:"number"}]),Emulator.PubSub.notify(GM_CONFIG.Events.SEEK_AUDIO,{handle:a,position:b})},gm.communication={},gm.communication.dialPhoneNumber=function(a,b,c){var d=Emulator.checkArgs(arguments,[{name:"success",type:"function",required:!1,"default":function(){}},{name:"failure",type:"function",required:!1,"default":function(){}},{name:"options",type:"object",required:!0,contents:{phone:{type:"string",required:!0},callParameters:{type:"object",required:!1,"default":{noiseSuppression:"Low",phoneSource:"Optimal",deviceHandle:0},contents:{noiseSuppression:{type:"string",required:!1,"default":"Low"},phoneSource:{type:"string",required:!1,"default":"Optimal"},deviceHandle:{type:"number",required:!1,"default":0}}}}}]);a=d[0],b=d[1],c=d[2];if(!Emulator.checkPhoneNumber(c.phone)){b();return}Emulator.Phone.successCallback=a,Emulator.Phone.failureCallback=b,Emulator.setValue(GM_CONFIG.ModelKeys.Communication.OutgoingPhone,c.phone),Emulator.PubSub.notify(GM_CONFIG.Events.NATIVE_APP,{method:"show",target:"phone_window_confirm"})},gm.communication.sendTextMessage=function(a,b,c){var d=Emulator.checkArgs(arguments,[{name:"success",type:"function",required:!1,"default":function(){}},{name:"failure",type:"function",required:!1,"default":function(){}},{name:"options",type:"object",required:!0,contents:{phone:{required:!0,type:"string"},message:{required:!0,type:"string"},deviceHandle:{required:!1,type:"number","default":0}}}]);a=d[0],b=d[1],c=d[2];if(!Emulator.checkPhoneNumber(c.phone)){b();return}Emulator.Text.successCallback=a,Emulator.Text.failureCallback=b,Emulator.setValue(GM_CONFIG.ModelKeys.Communication.TextNum,c.phone),Emulator.setValue(GM_CONFIG.ModelKeys.Communication.TextMessage,c.message),Emulator.PubSub.notify(GM_CONFIG.Events.NATIVE_APP,{method:"show",target:"text_message_confirm"})},gm.communication.sendFile=function(a,b,c){function i(){e.readyState==4&&(e.status==200?(a(e),c.deleteOnComplete&&gm.filesystem.deleteFile(c.fileURL)):b(e))}var d=Emulator.checkArgs(arguments,[{name:"success",type:"function",required:!1,"default":function(){}},{name:"failure",type:"function",required:!1,"default":function(){}},{name:"options",type:"object",required:!0,contents:{fileURL:{type:"string",required:!0},uploadURL:{type:"string",required:!0},deleteOnComplete:{type:"boolean",required:!1,"default":!0}}}]);a=d[0],b=d[1],c=d[2];if(gm.hmi.getNetworkConnectivity()==0){b({error:"No active network devices"});return}var e=new XMLHttpRequest,f="gm",g="--"+f,h=g+"\n"+'Content-Disposition: form-data; name="sendFile"; filename="'+Emulator.getBasename(c.fileURL)+'"'+"\n"+"Content-Type: application/octet-stream"+"\n"+"\n"+escape(gm.filesystem.readFile(c.fileURL))+"\n"+g;e.onreadystatechange=i,e.open("POST",c.uploadURL,!0),e.setRequestHeader("Content-type",'multipart/form-data; boundary="'+f+'"'),e.setRequestHeader("Content-length",h.length),e.send(h),Emulator.log(e)},gm.communication.getRadioInfo=function(a,b){var c=Emulator.checkArgs(arguments,[{name:"success",type:"function",required:!0},{name:"failure",type:"function",required:!1,"default":function(){}}]);a=c[0],b=c[1];var d={};d.band=Emulator.getValue(GM_CONFIG.ModelKeys.Radio.StationBand),d.station={channel:Emulator.getValue(GM_CONFIG.ModelKeys.Radio.StationChannel),title:Emulator.getValue(GM_CONFIG.ModelKeys.Radio.StationTitle)},d.song={title:Emulator.getValue(GM_CONFIG.ModelKeys.Radio.SongTitle),artist:Emulator.getValue(GM_CONFIG.ModelKeys.Radio.SongArtist),rds:Emulator.getValue(GM_CONFIG.ModelKeys.Radio.SongRDS)},a.call(this,d)},gm.communication.watchRadioInfo=function(a,b){var c=Emulator.checkArgs(arguments,[{name:"success",type:"function",required:!0},{name:"failure",type:"function",required:!1,"default":function(){}}]);a=c[0],b=c[1];var d=Emulator.Vehicle.subscribeToWatch(Emulator.Vehicle.RADIO_WATCH,a,b);return d},gm.communication.clearRadioInfo=function(a){Emulator.checkArgs(arguments,[{name:"watchID",type:"number",required:!0}]),Emulator.Vehicle.unsubscribeFromWatch(Emulator.Vehicle.RADIO_WATCH,a)},gm.communication.watchForData=function(a,b){var c=Emulator.checkArgs(arguments,[{name:"success",type:"function",required:!0},{name:"failure",type:"function",required:!0,"default":function(){}}]);a=c[0],b=c[1];try{var d=Emulator.getRequestingApp();if(d){var e=GM_CONFIG.Communication.APP_WATCH_PREFIX+d;Emulator.PubSub.publish(e);var f=Emulator.PubSub.subscribe(e,a);return f}b.call()}catch(g){b(g)}},gm.communication.clearWatchForData=function(a){var b=Emulator.checkArgs(arguments,[{name:"watchID",type:"number",required:!0}]),c=Emulator.getRequestingApp(),d=GM_CONFIG.Communication.APP_WATCH_PREFIX+c;Emulator.PubSub.unsubscribe(d,a)},gm.communication.getBTServices=function(a,b,c){var d=Emulator.checkArgs(arguments,[{name:"success",type:"function",required:!0},{name:"failure",type:"function",required:!1,"default":function(){}},{name:"options",type:"string",required:!1,"default":""}]);b=d[1];var e=Emulator.getValue(GM_CONFIG.ModelKeys.Bluetooth.ServiceList);if(typeof c=="string"){var f=[];for(var g=0;g<e.length;g++)(e[g].serviceName==c||e[g].UUID==c)&&f.push(e[g]);e=f}a(e)},gm.communication.watchBTServices=function(a,b,c){var d=Emulator.checkArgs(arguments,[{name:"success",type:"function",required:!0},{name:"failure",type:"function",required:!1,"default":function(){}},{name:"options",type:"string",required:!1,"default":""}]);a=d[0],b=d[1],Emulator.Bluetooth.WATCH_INDEX++;var e={};return typeof c=="string"&&c!=""&&(e={filter:c}),Emulator.addVehicleDataWatch(GM_CONFIG.BT_SERVICES.WATCH_PREFIX+Emulator.Bluetooth.WATCH_INDEX,[GM_CONFIG.ModelKeys.Bluetooth.ServiceList],function(a,b,c,d){var e=d.oldValue,f=d.value,g;if(c.filter){if(e.length>f.length)for(var h in e){var i=!1;for(var j in f)if(e[h].serviceNumber==f[j].serviceNumber){i=!0;break}if(!i){(e[h].serviceName==c.filter||e[h].UUID==c.filter)&&a(f);break}}else if(e.length<f.length)for(var h in f){var i=!1;for(var j in e)if(f[h].serviceNumber==e[j].serviceNumber){i=!0;break}if(!i){(f[h].serviceName==c.filter||f[h].UUID==c.filter)&&a(f);break}}else for(var h in f)if(f[h].UUID==c.filter||f[h].serviceName==c.filter)for(var k in f[h])if(f[h][k]!=e[h][k]){a(f);break}}else a(f)},a,b,e),Emulator.Bluetooth.WATCH_INDEX},gm.communication.clearBTServices=function(a){Emulator.checkArgs(arguments,[{name:"watchID",required:!0,type:"number"}]),Emulator.destroyVehicleWatch(GM_CONFIG.BT_SERVICES.WATCH_PREFIX+a)},gm.communication.sendToPhone=function(a,b,c,d){var e=Emulator.checkArgs(arguments,[{name:"success",type:"function",required:!1,"default":function(){}},{name:"failure",type:"function",required:!1,"default":function(){}},{name:"data",type:"object",required:!0},{name:"length",type:"number",required:!0}]);a=e[0],b=e[1];var f=Emulator.getRequestingApp(),g=Emulator.getValue(GM_CONFIG.ModelKeys.Network.SppParameters);if(g==null){b(GM_CONFIG.FailureCodes.NO_SPP_BINDING);return}if(f!=GM_CONFIG.SYSTEM_APP_ID)Emulator.sendToApp(GM_CONFIG.SYSTEM_APP_ID,0,c,GM_CONFIG.MessageTypes.PHONE),a();else{var h=Emulator.getValue(GM_CONFIG.ModelKeys.Bluetooth.ServiceList);if(h=h.length==0){b(GM_CONFIG.FailureCodes.NO_BT_CONNECTION);return}Emulator.PubSub.notify(GM_CONFIG.Events.SEND_SPP_DATA,{data:c,dataLength:d}),a()}},gm.communication.disconnectBTService=function(a,b){Emulator.checkTrustedApp(),Emulator.checkArgs(arguments,[{name:"serviceName",required:!0,type:"string"},{name:"deviceHandle",required:!1,type:"number","default":0}]);var c=Emulator.getValue(GM_CONFIG.ModelKeys.Bluetooth.ServiceList);for(var d=0;d<c.length;d++)if(c[d].serviceName==a){if(typeof b=="undefined"){Emulator.settingsController.BluetoothSettingController.removeBluetoothService(d);return}if(c[d].deviceHandle==b){Emulator.settingsController.BluetoothSettingController.removeBluetoothService(d);return}}},gm.communication.bindWithSPP=function(a,b,c){Emulator.checkTrustedApp();var d=Emulator.checkArgs(arguments,[{name:"success",required:!1,type:"function","default":function(){}},{name:"failure",required:!1,type:"function","default":function(){}},{name:"options",required:!0,type:"object",contents:{inFunction:{required:!0,type:"function"},disconnected:{required:!0,type:"function"},serviceName:{required:!0,type:"string"},deviceHandle:{required:!1,type:"number"}}}]);a=d[0],c.appID=Emulator.getRequestingApp(),Emulator.setValue(GM_CONFIG.ModelKeys.Network.SppParameters,c);var e=Emulator.PubSub.subscribe(GM_CONFIG.Events.SEND_FROM_PHONE,c.inFunction);return a(),e},gm.communication.sendSPPData=function(a){Emulator.checkTrustedApp(),Emulator.checkArgs(arguments,[{name:"options",required:!0,type:"object"}]);var b=Emulator.getValue(GM_CONFIG.ModelKeys.Network.SppParameters),c=Emulator.getValue(GM_CONFIG.ModelKeys.Bluetooth.ServiceList);return b==null?2:c==null||c.length==0?1:typeof a.data=="undefined"?3:(a.appID=Emulator.getRequestingApp(),Emulator.PubSub.notify(GM_CONFIG.Events.SEND_SPP_DATA,a),0)},gm.communication.sendToApp=function(a,b,c,d){if(typeof a!="number"||typeof b!="number"||typeof c=="undefined")return-1;var e=1;return typeof d!="undefined"&&typeof d.messageType=="number"&&(e=d.messageType),Emulator.sendToApp(a,b,c,e),0},gm.communication.getiAPAuthentication=function(a,b,c){Emulator.checkTrustedApp();var d=Emulator.checkArgs(arguments,[{name:"success",type:"function",required:!0},{name:"failure",type:"function",required:!1,"default":function(){}},{name:"token",type:"string",required:!0,"default":""}]),e=Emulator.getValue(GM_CONFIG.ModelKeys.Communication.IAPAuth);typeof e=="string"||typeof e=="number"?a(e+""):b(GM_CONFIG.FailureCodes.UNKNOWN)},gm.filesystem={},gm.filesystem.readFile=function(a,b){var c=Emulator.checkArgs(arguments,[{name:"filename",type:"string",required:!0},{name:"options",type:"object",required:!1,"default":{isPrivate:!1}}]);b=c[1];var d=Emulator.getRequestingApp(),e=Emulator.apps[d].folder,f=new XMLHttpRequest,g=Emulator.getValue(GM_CONFIG.ModelKeys.Username),h=e+"commands/readfile?filename="+escape(a)+"&username="+escape(g)+"&isprivate="+b.isPrivate,i="GET";return typeof f.overrideMimeType=="function"&&f.overrideMimeType("text/plain; charset=utf-8"),f.open(i,h,!1),f.send(),f.status==200?f.responseText:f.status==404?GM_CONFIG.FailureCodes.FILE_IO_NOT_FOUND:GM_CONFIG.FailureCodes.UNKNOWN},gm.filesystem.writeFile=function(filename,contents,overwrite,options){var args=Emulator.checkArgs(arguments,[{name:"filename",type:"string",required:!0},{name:"contents",type:"string",required:!0},{name:"overwrite",type:"number",required:!1,"default":0},{name:"options",type:"object",required:!1,"default":{isPrivate:!1}}]);overwrite=args[2],options=args[3];var response=Emulator.callServletCommand("writefile",{filename:filename,contents:contents,overwrite:overwrite,username:Emulator.getValue(GM_CONFIG.ModelKeys.Username),isprivate:options.isPrivate});if(response&&response.success==1){var val=response.request.responseText;if(val=="")return GM_CONFIG.FailureCodes.FILE_IO_SUCCESS;var result=eval("("+val+")");switch(result.error){case"SIZE_LIMIT_ERROR":return GM_CONFIG.FailureCodes.FILE_IO_LIMIT_EXCEEDED;case"ACCESS_DENIED_ERROR":return GM_CONFIG.FailureCodes.FILE_IO_ACCESS_DENIED;default:return GM_CONFIG.FailureCodes.UNKNOWN}}return GM_CONFIG.FailureCodes.UNKNOWN},gm.filesystem.deleteFile=function(filename,options){var args=Emulator.checkArgs(arguments,[{name:"filename",type:"string",required:!0},{name:"options",type:"object",required:!1,"default":{isPrivate:!1}}]);options=args[1];var response=Emulator.callServletCommand("deletefile",{filename:filename,username:Emulator.getValue(GM_CONFIG.ModelKeys.Username),isprivate:options.isPrivate});if(response&&response.success==1){var val=response.request.responseText;if(val=="")return GM_CONFIG.FailureCodes.FILE_IO_SUCCESS;var result=eval("("+val+")");switch(result.error){case"NOT_FOUND_ERROR":return GM_CONFIG.FailureCodes.FILE_IO_NOT_FOUND;case"ACCESS_DENIED_ERROR":return GM_CONFIG.FailureCodes.FILE_IO_ACCESS_DENIED;default:return GM_CONFIG.FailureCodes.UNKNOWN}}else response&&response.error&&console.log(response.error);return GM_CONFIG.FailureCodes.UNKNOWN},gm.filesystem.writeBinaryFile=function(filename,contents,options){function isArray(a){return a.constructor.toString().indexOf("Array")==-1?!1:!0}typeof options=="undefined"&&(options={});var isPrivate=typeof options.isPrivate=="boolean"?options.isPrivate:!1,overwrite=typeof options.overwrite=="number"?options.overwrite:0,response=Emulator.callServletCommand("writebinaryfile",{filename:filename,contents:contents,username:Emulator.getValue(GM_CONFIG.ModelKeys.Username),isprivate:isPrivate,overwrite:overwrite});if(response&&response.success==1){var val=response.request.responseText;if(val=="")return GM_CONFIG.FailureCodes.FILE_IO_SUCCESS;var result=eval("("+val+")");switch(result.error){case"SIZE_LIMIT_ERROR":return GM_CONFIG.FailureCodes.FILE_IO_LIMIT_EXCEEDED;case"ACCESS_DENIED_ERROR":return GM_CONFIG.FailureCodes.FILE_IO_ACCESS_DENIED;default:return GM_CONFIG.FailureCodes.UNKNOWN}}return GM_CONFIG.FailureCodes.UNKNOWN},gm.filesystem.getResource=function(filename,options){var args=Emulator.checkArgs(arguments,[{name:"filename",type:"string",required:!0},{name:"options",type:"object",required:!1,"default":{number:0}}]);filename=args[0],number=args[1].number;var requestingApp=Emulator.getRequestingApp(),appFolder=Emulator.apps[requestingApp].folder,req=new XMLHttpRequest,url=appFolder+"commands/getresource?filename="+escape(filename),method="get";req.open(method,url,!1),req.send();if(req.status==200){var respObj=eval("("+req.responseText+")");return respObj.success==1?respObj.path:null}return!1},gm.hmi={},gm.hmi.setFavorite=function(a,b,c){var d=Emulator.checkArgs(arguments,[{name:"success",type:"function",required:!0},{name:"failure",type:"function",required:!1,"default":function(){}},{name:"options",type:"object",required:!0,contents:{title:{required:!0,type:"string"},URL:{required:!1,type:"string"},position:{required:!1,type:"number","default":null}}}]);a=d[0],b=d[1],c=d[2];if(!c.URL||Emulator.Favorites.linkIsApp(c.URL)){var e=Emulator.getRequestingApp();c.URL=c.URL||"",c.URL=Emulator.apps[e].folder+c.URL}var f=Emulator.Favorites.addFavorite(c.title,c.URL,c.position);return a(f),f},gm.hmi.watchProximity=function(a,b){var c=Emulator.checkArgs(arguments,[{name:"success",required:!0,type:"function"},{name:"failure",required:!1,type:"function","default":function(){}}]);return a=c[0],b=c[1],Emulator.Vehicle.proximityWatchIndex++,Emulator.addVehicleDataWatch("PROXIMITY_WATCH_"+Emulator.Vehicle.proximityWatchIndex,[GM_CONFIG.ModelKeys.Status.Proximity],function(a,b){var c=Emulator.getValue(GM_CONFIG.ModelKeys.Status.Proximity);a(c)},a,b),Emulator.Vehicle.proximityWatchIndex},gm.hmi.clearProximity=function(a){Emulator.checkArgs(arguments,[{name:"ProximityHandle",required:!0,type:"number"}]),Emulator.destroyVehicleWatch("PROXIMITY_WATCH_"+a)},gm.hmi.watchRotaryControl=function(a,b){var c=Emulator.checkArgs(arguments,[{name:"success",required:!0,type:"function"},{name:"failure",required:!1,type:"function","default":function(){}}]);a=c[0],b=c[1];var d=Emulator.Vehicle.subscribeToWatch(Emulator.Vehicle.ROTARY_WATCH,a,b);return d},gm.hmi.clearRotaryControl=function(a){Emulator.checkArgs(arguments,[{name:"RotaryHandle",required:!0,type:"number"}]),Emulator.Vehicle.unsubscribeFromWatch(Emulator.Vehicle.ROTARY_WATCH,a)},gm.hmi.watchButtons=function(a,b,c){var d=Emulator.checkArgs(arguments,[{name:"success",required:!0,type:"function"},{name:"failure",required:!1,type:"function","default":function(){}},{name:"options",required:!1,type:"object","default":{}}]);a=d[0],b=d[1];var e=function(b){if(typeof c.length!="undefined"&&c.length>0){for(var d=0;d<c.length;d++)if(b==c[d]){a(b);break}}else a(b)},f=Emulator.Vehicle.subscribeToWatch(Emulator.Vehicle.SOFT_KEY_WATCH,e,b);return f},gm.hmi.clearButtons=function(a){Emulator.checkArgs(arguments,[{name:"watchID",required:!0,type:"number"}]),Emulator.Vehicle.unsubscribeFromWatch(Emulator.Vehicle.SOFT_KEY_WATCH,a)},gm.hmi.getUser=function(){var a;return gm.networkmanager.getAuthToken(function(b){a=b.username},function(){throw new Error("Failed to get user.")}),a},gm.hmi.getNetworkConnectivity=function(){return Emulator.getValue(GM_CONFIG.ModelKeys.Network.NetworkConnectivity)},gm.hmi.watchNetworkConnectivity=function(a,b){var c=Emulator.checkArgs(arguments,[{name:"success",required:!0,type:"function"},{name:"failure",required:!1,type:"function","default":function(){}}]);return b=c[1],Emulator.Vehicle.connectivityWatchIndex++,Emulator.addVehicleDataWatch("NETWORK_CONNECTIVITY_WATCH_"+Emulator.Vehicle.connectivityWatchIndex,[GM_CONFIG.ModelKeys.Network.NetworkConnectivity],function(a){a(gm.hmi.getNetworkConnectivity())},a,b),Emulator.Vehicle.connectivityWatchIndex},gm.hmi.clearNetworkConnectivity=function(a){Emulator.checkArgs(arguments,[{name:"watchID",required:!0,type:"number"}]),Emulator.destroyVehicleWatch("NETWORK_CONNECTIVITY_WATCH_"+a)},gm.hmi.showAlert=function(a,b,c){var d=Emulator.checkArgs(arguments,[{name:"success",required:!1,type:"function","default":function(){}},{name:"failure",required:!1,type:"function","default":function(){}},{name:"options",required:!0,type:"object",contents:{alertTitle:{type:"string",required:!0},alertDetail:{type:"string",required:!0},primaryAction:{type:"function",required:!0},secondaryAction:{type:"function",required:!0},primaryButtonText:{type:"string",required:!0},secondaryButtonText:{type:"string",required:!0}}}]);a=d[0],b=d[1],c=d[2],Emulator.Alert.callbackQueue.push({primaryAction:c.primaryAction,secondaryAction:c.secondaryAction}),Emulator.Alert.primaryAction=c.primaryAction,Emulator.Alert.secondaryAction=c.secondaryAction,Emulator.PubSub.notify(GM_CONFIG.Events.NATIVE_APP,{method:"show",target:"show_alert",attributes:c}),a()},gm.hmi.setInteractionSelector=function(a,b){var c=[];try{for(var d=1;d<=10;d++){var e="button"+d;if(typeof a[e+"_text"]=="undefined"||typeof a[e+"_action"]=="undefined")continue;var f=a[e+"_type"].toLowerCase()=="icon"?"icon":"text",g={id:e,type:f,text:f=="text"?a[e+"_text"]:null,icon:f=="icon"?a[e+"_text"]:null,onclick:a[e+"_action"]};c.push(g)}}catch(h){typeof b=="function"&&b(h)}Emulator.interactionSelectorController.render(Emulator.getRequestingApp(),c)},gm.hmi.watchActiveDeviceConnected=function(a,b){var c=Emulator.checkArgs(arguments,[{name:"success",required:!0,type:"function"},{name:"failure",required:!1,type:"function","default":function(){}}]),d=Emulator.PubSub.subscribe(GM_CONFIG.Events.DEVICE_CONNECTION,function(b){var c=Emulator.getValue(GM_CONFIG.ModelKeys.Network.ActiveDeviceOverride);if(c!=null){a(c);return}var d=b.oldValue,e=b.value;if(d.length>e.length){for(var f in d)if(typeof e[f]=="undefined"&&d[f].connectionStatus==GM_CONFIG.NETWORK_MANAGER.Connection_Statuses.ENABLED_ACTIVE){a(!1);break}}else if(d.length<e.length){for(var f in e)if(typeof d[f]=="undefined"&&e[f].connectionStatus==GM_CONFIG.NETWORK_MANAGER.Connection_Statuses.ENABLED_ACTIVE){a(!0);break}}else for(var f in e){if(d[f].connectionStatus==GM_CONFIG.NETWORK_MANAGER.Connection_Statuses.ENABLED_ACTIVE&&e[f].connectionStatus!=GM_CONFIG.NETWORK_MANAGER.Connection_Statuses.ENABLED_ACTIVE){a(!1);break}if(e[f].connectionStatus==GM_CONFIG.NETWORK_MANAGER.Connection_Statuses.ENABLED_ACTIVE&&d[f].connectionStatus!=GM_CONFIG.NETWORK_MANAGER.Connection_Statuses.ENABLED_ACTIVE){a(!0);break}}});return a(),d},gm.hmi.clearActiveDeviceConnected=function(a){var b=Emulator.checkArgs(arguments,[{name:"watchID",required:!0,type:"number"}]);Emulator.PubSub.unsubscribe(GM_CONFIG.Events.DEVICE_CONNECTION,a)},gm.hmi.watchSteeringWheelControls=function(a,b){var c=Emulator.checkArgs(arguments,[{name:"success",required:!0,type:"function"},{name:"failure",required:!1,type:"function","default":function(){}}]);a=c[0],b=c[1];var d=Emulator.Vehicle.subscribeToWatch(Emulator.Vehicle.SWC_WATCH,a,b);return d},gm.hmi.clearSteeringWheelControls=function(a){Emulator.checkArgs(arguments,[{name:"SWCHandle",required:!0,type:"number"}]),Emulator.Vehicle.unsubscribeFromWatch(Emulator.Vehicle.SWC_WATCH,a)},gm.hmi.setHomeScreenLocation=function(a,b){var c=Emulator.checkArgs(arguments,[{name:"position",required:!0,type:"number"},{name:"force",required:!1,type:"boolean","default":!0}]);b=c[1];var d=Emulator.getRequestingApp();Emulator.homeScreenController.setHomeScreenLocation(a,d)},gm.hmi.setActiveDeviceConnected=function(a){Emulator.checkTrustedApp();var b=null;switch(a){case 0:b=!1;break;case 1:b=!0;break;case 2:var c=Emulator.getValue(GM_CONFIG.ModelKeys.Network.ActiveDeviceOverride);if(c==0)b=!0;else if(c==1)b=!1;else return;break;case 3:b=null;break;default:return}Emulator.setValue(GM_CONFIG.ModelKeys.Network.ActiveDeviceOverride,b)},gm.hmi.setHomePositions=function(a,b,c){Emulator.checkTrustedApp();for(var d=0;d<c.length;d++)Emulator.homeScreenController.setHomeScreenLocation(c[d].position,c[d].appID);a()},gm.navigation={},gm.navigation.getDestination=function(a,b){var c=Emulator.checkArgs(arguments,[{name:"success",required:!0,type:"function"},{name:"failure",required:!1,type:"function","default":function(){}}]);a=c[0],b=c[1];var d=Emulator.getValue(GM_CONFIG.ModelKeys.Driving.Destination);d?a(d):b("Destination is not defined.")},gm.navigation.setDestination=function(a,b,c){var d=Emulator.checkArgs(arguments,[{name:"success",required:!1,type:"function","default":function(){}},{name:"failure",required:!1,type:"function","default":function(){}},{name:"options",type:"object",required:!0}]);a=d[0],b=d[1],c=d[2];var e=!1;if(typeof c.latitude=="undefined"||isNaN(parseFloat(c.latitude)))e=!0;if(typeof c.longitude=="undefined"||isNaN(parseFloat(c.longitude)))e=!0;if(e){var f;f=new google.maps.Geocoder;var g="";typeof c.address!="undefined"&&c.address!=""?g=c.address:(typeof c.house!="undefined"&&c.house!=""&&(g+=c.house),typeof c.street!="undefined"&&c.street!=""&&(g=g+" "+c.street),typeof c.city!="undefined"&&c.city!=""&&(g=g+", "+c.city),typeof c.state!="undefined"&&c.state!=""&&(g=g+" "+c.state),typeof c.zip!="undefined"&&c.zip!=""&&(g=g+" "+c.zip),typeof c.province!="undefined"&&c.province!=""&&(g=g+" "+c.province),typeof c.country!="undefined"&&c.country!=""&&(g=g+" "+c.country)),f.geocode({address:g},function(d,e){if(e==google.maps.GeocoderStatus.OK){c.latitude=36e5*parseFloat(d[0].geometry.location.$a),c.longitude=36e5*parseFloat(d[0].geometry.location.ab);try{Emulator.setDestination(c,a,b)}catch(f){console.log(f),b()}}else b()})}else try{Emulator.setDestination(c,a,b)}catch(h){console.log(h),b()}},gm.networkmanager={},gm.networkmanager._getAuthToken=function(){var a=gm.networkmanager._getOutgoingDevice();if(!a)return null;var b={};b.deviceAddress=a;for(var c in GM_CONFIG.NETWORK_MANAGER.User_Device_List)GM_CONFIG.NETWORK_MANAGER.User_Device_List[c].deviceAddress==a&&(b.number=GM_CONFIG.NETWORK_MANAGER.User_Device_List[c].number);var d=GM_CONFIG.NETWORK_MANAGER.Auth_Tokens;for(var c in d[a]){var e=d[a][c];if(e.active){for(var f in e)b[f]=e[f];return b}}return null},gm.networkmanager._getOutgoingDevice=function(){var a=Emulator.getValue(GM_CONFIG.ModelKeys.Network.DeviceList),b=!1;for(var c in a)a[c].outgoingSource&&(b=a[c].deviceAddress);return b},gm.networkmanager._removeNonschemaFields=function(){var a=Emulator.getValue(GM_CONFIG.ModelKeys.Network.DeviceList);for(var b in a)a[b].connected&&delete a[b].connected,a[b].internet&&delete a[b].internet,a[b].signalStrength&&delete a[b].signalStrength,a[b].secure&&delete a[b].secure,a[b].previouslyConnected&&delete a[b].previouslyConnected;return a},gm.networkmanager.setDUNParameters=function(a,b,c){Emulator.checkTrustedApp();var d=Emulator.checkArgs(arguments,[{name:"success",type:"function",required:!0},{name:"failure",required:!1,type:"function","default":function(){}},{name:"options",required:!0,type:"object",contents:{username:{required:!0,type:"string"},password:{required:!0,type:"string"},APNName:{required:!1,type:"string"},serverPassword:{required:!1,type:"string"},dialUpNumber:{required:!0,type:"string"}}}]);a=d[0],b=d[1],c=d[2];var e={},f={},g={},h=Emulator.generateMACAddress(),i=c.username,j=Emulator.generateAuthToken(),k=GM_CONFIG.DefaultTokenExpiration,l=!0;for(var m in GM_CONFIG.NETWORK_MANAGER.User_Device_List)GM_CONFIG.NETWORK_MANAGER.User_Device_List[m].active=!1;var n="Bluetooth Connection",o=GM_CONFIG.NETWORK_MANAGER.Device_Types.DT_Bluetooth,p=GM_CONFIG.NETWORK_MANAGER.Connection_Types.DUN,q=!0,r=GM_CONFIG.NETWORK_MANAGER.Connection_Statuses.NOT_AVAILABLE;for(var m in GM_CONFIG.NETWORK_MANAGER.Device_List)GM_CONFIG.NETWORK_MANAGER.Device_List[m].outgoingSource=!1,GM_CONFIG.NETWORK_MANAGER.Device_List[m].connectionStatus=2;g.authToken=j,g.username=i,g.expiration=k,g.active=!0,GM_CONFIG.NETWORK_MANAGER.Auth_Tokens[h]=[g],e.friendlyName=n,e.deviceAddress=h,e.outgoingSource=q,e.deviceType=o,e.connectionType=p,e.connectionStatus=r,e.phoneNumber=c.dialUpNumber;var s=Emulator.getValue(GM_CONFIG.ModelKeys.Network.DeviceList);s.push(e),Emulator.setValue(GM_CONFIG.ModelKeys.Network.DeviceList,s);for(var m in GM_CONFIG.NETWORK_MANAGER.User_Device_List)if(GM_CONFIG.NETWORK_MANAGER.User_Device_List[m].username==i){GM_CONFIG.NETWORK_MANAGER.User_Device_List[m].deviceAddress=h,GM_CONFIG.NETWORK_MANAGER.User_Device_List[m].authToken=j,GM_CONFIG.NETWORK_MANAGER.User_Device_List[m].active=l,GM_CONFIG.NETWORK_MANAGER.User_Device_List[m].expiration=k,a.call(this);return}b.call(this)},gm.networkmanager.getDeviceList=function(a,b,c){Emulator.checkTrustedApp();var d=Emulator.checkArgs(arguments,[{name:"success",type:"function",required:!0},{name:"failure",type:"function",required:!1,"default":function(){}},{name:"filters",required:!1,type:"object","default":{}}]);a=d[0],b=d[1],c=d[2];var e=[],f=Emulator.getValue(GM_CONFIG.ModelKeys.Network.DeviceList),g="friendlyName id deviceAddress outgoingSource deviceType connectionStatus connectionType internet signalStrength secure previouslyConnected lastConnected".split(" ");for(var h in f){var i={};for(var j in g)i[g[j]]=f[h][g[j]];var k=!1;i.connectionStatus==3&&(k=!0);var l="UNKNOWN";switch(i.connectionType){case 0:l="SPP";break;case 1:l="DUN";break;case 2:l="PAN";break;case 3:l="WIFI";break;case 4:l="TELEMATICS";break;default:l="DISABLED"}i.connectionStatus,i.connectionType,i.connected=k,i.internet=l,i.security=0,i.signalStrength=1,i.secure=0,i.previouslyConnected=!1,e.push(i)}var m=[];for(var h=0;h<e.length;h++)console.log(e[h]),c.friendlyName!=undefined&&c.friendlyName==e[h].friendlyName&&m.push(e[h]),c.deviceHandle!=undefined&&c.deviceHandle==e[h].id&&m.push(e[h]),c.deviceAddress!=undefined&&c.deviceAddress==e[h].deviceAddress&&m.push(e[h]),c.outgoingSource!=undefined&&c.outgoingSource==e[h].outgoingSource&&m.push(e[h]),c.deviceType!=undefined&&c.deviceType==e[h].deviceType&&m.push(e[h]),e[h].connectionStatus==3&&c.connected&&m.push(e[h]);m.length>0?a(m):a(e)},gm.networkmanager.getPhoneNumber=function(){Emulator.checkTrustedApp();var a=Emulator.getValue(GM_CONFIG.ModelKeys.Network.DeviceList),b=!1;for(var c in a)a[c].outgoingSource&&a[c].deviceType==GM_CONFIG.NETWORK_MANAGER.Device_Types.DT_Bluetooth&&(b=a[c].phoneNumber);return b},gm.networkmanager.setAuthToken=function(a,b,d){Emulator.checkTrustedApp(),Emulator.checkTrustedApp();var e=Emulator.checkArgs(arguments,[{name:"success",required:!0,type:"function"},{name:"failure",required:!1,type:"function","default":function(){}},{name:"options",required:!0,type:"object",contents:{authToken:{required:!0,type:"string"},deviceAddress:{required:!0,type:"string"},username:{required:!0,type:"string"},expiration:{required:!1,type:"object","default":new Date(3e3,1,1)}}}]);a=e[0],b=e[1],d=e[2];try{localStorage.setItem("currentUser",JSON.stringify(d)),a()}catch(f){localStorage.setItem("currentUser",JSON.stringify(c)),b()}},gm.networkmanager.getAuthToken=function(a,b){Emulator.checkTrustedApp();var c=Emulator.checkArgs(arguments,[{name:"success",required:!0,type:"function"},{name:"failure",required:!1,type:"function","default":function(){}}]);a=c[0],b=c[1];var d;try{if(localStorage.getItem("currentUser")!=null){d=JSON.parse(localStorage.getItem("currentUser")),d.expiration=new Date(d.expiration),d.active=d.active==1,d.number=(new Date).getTime(),d.username=d.username.toUpperCase(),a(d);return}var e=gm.networkmanager._getAuthToken();e==null?b():a(e);return}catch(f){console.warn("gm.networkmanager.getAuthToken failed because:",f),b.call(this);return}},gm.networkmanager.getNetworkAvailability=function(a,b){Emulator.checkTrustedApp();var c=Emulator.checkArgs(arguments,[{name:"success",required:!0,type:"function"},{name:"failure",required:!1,type:"function","default":function(){}}]);a=c[0],b=c[1];var d=[],e=Emulator.getValue(GM_CONFIG.ModelKeys.Network.DeviceList);for(var f in e){var g={};g.connectionType=e[f].connectionType,g.connectionStatus=e[f].connectionStatus,d.push(g)}a(d)},gm.networkmanager.setActiveAuthToken=function(a){Emulator.checkTrustedApp();var b=Emulator.checkArgs(arguments,[{name:"authToken",required:!0,type:"string"}]),a=b[0],c=GM_CONFIG.NETWORK_MANAGER.Auth_Tokens;for(var d in c){var e=!1;devTokens=c[d];for(var f in devTokens)if(a==devTokens[f].authToken){e=!0;break}if(e)for(var f in devTokens)a==devTokens[f].authToken?GM_CONFIG.NETWORK_MANAGER.Auth_Tokens[d][f].active=!0:GM_CONFIG.NETWORK_MANAGER.Auth_Tokens[d][f].active=!1}},gm.networkmanager.connectViaSPP=function(a,b){Emulator.checkTrustedApp(),Emulator.checkArgs(arguments,[{name:"toBackOffice",type:"boolean",required:!0},{name:"toInternet",type:"boolean",required:!0}]);var c=Emulator.getValue(GM_CONFIG.ModelKeys.Network.SppInternetFunction);return c==null?1:(Emulator.setValue(GM_CONFIG.ModelKeys.Network.SppToBackOffice,a),Emulator.setValue(GM_CONFIG.ModelKeys.Network.SppToInternet,b),0)},gm.networkmanager.setSPPInternet=function(a,b){Emulator.checkTrustedApp();var c=Emulator.checkArgs(arguments,[{name:"success",type:"function",required:!0},{name:"failure",type:"function",required:!1,"default":function(){}}]);a=c[0],b=c[1];var d=Emulator.getValue(GM_CONFIG.ModelKeys.Network.SppInternetFunction);return d!=null?(b("SPP INTERNET FUNCTION ALREADY SET"),null):(Emulator.setValue(GM_CONFIG.ModelKeys.Network.SppInternetFunction,a.toString()),0)},gm.networkmanager.clearSPPInternetFunction=function(a){Emulator.checkTrustedApp(),Emulator.checkArgs(arguments,[{name:"funcID",type:"number",required:!0}]),Emulator.setValue(GM_CONFIG.ModelKeys.Network.SppInternetFunction,null),Emulator.setValue(GM_CONFIG.ModelKeys.Network.SppToBackOffice,!1),Emulator.setValue(GM_CONFIG.ModelKeys.Network.SppToInternet,!1)},gm.networkmanager.setWIFIParameters=function(a,b,c){Emulator.checkTrustedApp();var d=Emulator.checkArgs(arguments,[{name:"success",type:"function",required:!0},{name:"failure",required:!1,type:"function","default":function(){}},{name:"options",required:!0,type:"object",contents:{address:{required:!1,type:"string"},SSID:{required:!1,type:"string"},password:{required:!1,type:"string"},security:{required:!1,type:"enum"},staticIP:{required:!1,type:"string"},mask:{required:!1,type:"string"}}}]);gm.networkmanager.getDeviceList(function(b){for(var d=0;d<b.length;d++)if(b[d].deviceAddress==c.deviceAddress){gm.networkmanager.setConnectedDevice(b[d].deviceAddress,b[d].deviceType);break}a(b)},b)},gm.networkmanager.setDeviceData=function(a,b){Emulator.checkTrustedApp();var c=Emulator.checkArgs(arguments,[{name:"deviceAddress",type:"string",required:!0},{name:"enable",required:!0,type:"boolean"}]);return a=c[0],b=c[1],0},gm.networkmanager.setConnectedDevice=function(a,b,c){Emulator.checkTrustedApp();var d=Emulator.checkArgs(arguments,[{name:"deviceHandle",type:"string",required:!0},{name:"deviceType",type:"string",required:!1,"default":""},{name:"options",type:"object",required:!1,"default":{},contents:{persistPriority:{required:!1,type:"boolean"}}}]);return a=d[0],b=d[1],c=d[2],Emulator.setValue(GM_CONFIG.ModelKeys.NetworkData.id,a),0},gm.networkmanager.removeDevice=function(a){Emulator.checkTrustedApp();var b=Emulator.checkArgs(arguments,[{name:"deviceAddress",type:"string",required:!0}]);a=b[0];var c=!1;return gm.networkmanager.getDeviceList(function(b){for(var d in b)console.log(b[d]),b[d].deviceAddress==a&&(b.splice(d,1),c=!0);c&&(b=gm.networkmanager._removeNonschemaFields(),Emulator.setValue(GM_CONFIG.ModelKeys.Network.DeviceList,b))}),!0},gm.networkmanager.getPhoneCarrier=function(){return Emulator.checkTrustedApp(),GM_CONFIG.DefaultBTService},gm.networkmanager.deleteAuthToken=function(a,b,c){Emulator.checkTrustedApp();var d=Emulator.checkArgs(arguments,[{name:"success",type:"function",required:!1,"default":function(){}},{name:"failure",required:!1,type:"function","default":function(){}},{name:"number",required:!0,type:"int"}]);a=d[0],b=d[1],c=d[2]},gm.networkmanager.getUserDeviceTable=function(a,b){Emulator.checkTrustedApp();var c=Emulator.checkArgs(arguments,[{name:"success",type:"function",required:!0},{name:"failure",required:!1,type:"function","default":function(){}}]);a=c[0],b=c[1],a(GM_CONFIG.NETWORK_MANAGER.User_Device_List)},gm.networkmanager.setAutoSwitch=function(a,b,c){Emulator.checkTrustedApp();var d=Emulator.checkArgs(arguments,[{name:"success",type:"function",required:!0},{name:"failure",required:!1,type:"function","default":function(){}},{name:"value",required:!0,type:"enum"}]);a=d[0],b=d[1],c=d[2],a()},gm.networkmanager.setConnectionPriority=function(a){Emulator.checkTrustedApp();var b=Emulator.checkArgs(arguments,[{name:"priorityList",type:"object",required:!0}]);a=b[0];var c=!1,d=!1;for(var e in a){var f=a[e];for(var g in GM_CONFIG.NETWORK_MANAGER.Device_Types)f==g&&(c=!0)}for(var e in a){var h=a[e];for(var i in GM_CONFIG.NETWORK_MANAGER.Connection_Types)h==i&&(d=!0)}if(c&&d)return 2;if(!c&&!d)return 3;try{return Emulator.setValue(GM_CONFIG.ModelKeys.Network.NetworkPriority,a),0}catch(j){return 1}},gm.POISearch={},gm.POISearch.setPOIProviderInfo=function(a,b){Emulator.checkTrustedApp();var c=Emulator.checkArgs(arguments,[{name:"providerName",type:"string",required:!0},{name:"iconURL",type:"string",required:!0}]),d={providerName:a,iconURL:b};Emulator.setValue(GM_CONFIG.ModelKeys.POISearch.ProviderInfo,d)},gm.POISearch.setPOISearchSettings=function(a){Emulator.checkTrustedApp();var b=Emulator.checkArgs(arguments,[{name:"options",type:"object",required:!0}]),c=Emulator.getValue(GM_CONFIG.ModelKeys.POISearch.POISearchSettings)||{};a.sortingState&&0<=a.sortingState<=7&&(c.sortingState=a.sortingState),typeof a.alongRoute=="boolean"&&(c.alongRoute=a.alongRoute),Emulator.setValue(GM_CONFIG.ModelKeys.POISearch.POISearchSettings,c)},gm.POISearch.watchPOISearch=function(a,b){Emulator.checkTrustedApp();var c=Emulator.checkArgs(arguments,[{name:"success",type:"function",required:!0},{name:"failure",type:"function",required:!1,"default":function(){}}]);a=c[0],b=c[1];var d=Emulator.PubSub.subscribe(GM_CONFIG.POISearch.APP_WATCH,a);return d},gm.POISearch.clearPOISearch=function(a){Emulator.checkTrustedApp();var b=Emulator.checkArgs(arguments,[{name:"watchID",type:"number",required:!0}]);Emulator.PubSub.unsubscribe(GM_CONFIG.POISearch.APP_WATCH,a)},gm.POISearch.searchResults=function(a,b){Emulator.checkTrustedApp();var c=Emulator.checkArgs(arguments,[{name:"searchHandle",type:"string",required:!0},{name:"resultList",type:"object",required:!0}]);Emulator.PubSub.notify(GM_CONFIG.Events.SEARCH_RESULTS,{searchHandle:a,resultList:b,appID:Emulator.getRequestingApp(),type:"Search"})},gm.POISearch.moreSearchResults=function(a){Emulator.checkTrustedApp();var b=Emulator.checkArgs(arguments,[{name:"value",type:"boolean",required:!0}]);Emulator.setValue(GM_CONFIG.ModelKeys.POISearch.ResultsAvailable,a)},gm.POISearch.autocompleteResults=function(a,b){Emulator.checkTrustedApp();var c=Emulator.checkArgs(arguments,[{name:"inString",type:"string",required:!0},{name:"results",type:"object",required:!0}]);Emulator.PubSub.notify(GM_CONFIG.Events.SEARCH_RESULTS,{searchHandle:a,resultList:b,appID:Emulator.getRequestingApp(),type:"Autocomplete"})},gm.speech={},gm.speech.startSpeechRecSession=function(a,b){return Emulator.Speech.srSessionHandle++,Emulator.Speech.srSessionStarted=!0,a(Emulator.Speech.srSessionHandle),Emulator.Speech.srSessionHandle},gm.speech.stopSpeechRecSession=function(a){try{gm.speech.srSessionStarted=!1,gm.speech.stopRecording()}catch(b){}return},gm.speech.startRecording=function(a,b,c){if(!Emulator.Speech.srSessionStarted){b("must call startSpeechRecSession before calling startRecording");return}typeof c=="undefined"&&(c={}),Emulator.Speech.recordingSession=new Emulator.Speech.RecordingSession(c);var d=Emulator.getRequestingApp(),e=Emulator.apps[d].folder;return typeof Emulator.Speech.recordingSession.intro=="string"?gm.speech.startTTS(Util.bind(this,Emulator.Speech.record,[a,b,e]),b,Emulator.Speech.recordingSession.intro):Emulator.Speech.record(a,b,e),Emulator.Speech.recordingHandle++,Emulator.Speech.recordingHandle},gm.speech.stopRecording=function(a){var b=Emulator.getRequestingApp(),c=Emulator.apps[b].folder,d=new XMLHttpRequest,e="stop=true",f=c+"commands/recordaudio"+(window.location.search==""?"?":window.location.search)+e,g="get";d.open(g,f,!1),d.send(null);if(d.readyState==4)return d.status==200?!0:!1},gm.speech.startTTS=function(a,b,c){var d=Emulator.mediaPlayerController.getNewTTSHandle();return Emulator.PubSub.notify(GM_CONFIG.Events.START_TTS,{handle:d,text:c,success:a,failure:b}),d},gm.speech.stopTTS=function(a){Emulator.PubSub.notify(GM_CONFIG.Events.STOP_TTS,{handle:a})},gm.vehicle={},gm.vehicle.getCurrentPosition=function(a,b,c){var d=Emulator.checkArgs(arguments,[{name:"success",type:"function",required:!0},{name:"failure",type:"function",required:!1,"default":function(){}},{name:"options",type:"object",required:!1,"default":{},contents:{maximumAge:{required:!1,type:"number","default":9999999},timeout:{required:!1,type:"number","default":9999999},frequency:{required:!1,type:"number","default":1e3}}}]);a=d[0],b=d[1],c=d[2];var e={coords:{latitude:Emulator.getValue(GM_CONFIG.VehicleData.GPS_Geographical_Position_LS.gps_lat.model.key),longitude:Emulator.getValue(GM_CONFIG.VehicleData.GPS_Geographical_Position_LS.gps_long.model.key),heading:Emulator.getValue(GM_CONFIG.VehicleData.GPS_Elevation_and_Heading_LS.gps_heading.model.key),altitude:Emulator.getValue(GM_CONFIG.VehicleData.GPS_Elevation_and_Heading_LS.gps_elevation.model.key)},timestamp:Emulator.getValue(GM_CONFIG.ModelKeys.GPS.Timestamp)};(new Date).getTime()-(new Date(e.timestamp)).getTime()>c.maximumAge?b(e):a(e)},gm.vehicle.watchPosition=function(a,b,c){var d=Emulator.checkArgs(arguments,[{name:"success",type:"function",required:!0},{name:"failure",type:"function",required:!1,"default":function(){}},{name:"options",type:"object",required:!1,"default":{},contents:{maximumAge:{required:!1,type:"number","default":9999999},timeout:{required:!1,type:"number","default":9999999},frequency:{required:!1,type:"number","default":1e3}}}]);return a=d[0],b=d[1],c=d[2],setInterval(function(){gm.vehicle.getCurrentPosition(a,b,c)},c.frequency)},gm.vehicle.clearPosition=function(a){Emulator.checkArgs(arguments,[{name:"watchID",type:"number",required:!0}]),clearInterval(a)},gm.vehicle._getVehicleModelKeys=function(a){var b={};for(var c in a){var d=a[c];for(var e in GM_CONFIG.VehicleData)for(var f in GM_CONFIG.VehicleData[e])d==f&&typeof GM_CONFIG.VehicleData[e][f].model!="undefined"&&(b[d]=GM_CONFIG.VehicleData[e][f].model.key)}return b};var defaultVehicleDataOptions=[];for(var group in GM_CONFIG.VehicleData)for(var gm_signal in GM_CONFIG.VehicleData[group])gm_signal!="disable"&&defaultVehicleDataOptions.push(gm_signal);gm.vehicle.getVehicleData=function(a,b,c){a=a?a:function(){},b=b?b:function(){},c=c?c:defaultVehicleDataOptions;var d={},e=gm.vehicle._getVehicleModelKeys(c);for(var f in e){var g=Emulator.getValue(e[f]);typeof g=="string"&&(g=parseInt(g,16)),d[f]=g*1}a.call(this,d)},gm.vehicle._vehicle_data_watch_count=0,gm.vehicle._vehicle_data_watch_prefix="VehicleDataWatch//",gm.vehicle.watchVehicleData=function(a,b,c){var d=Emulator.checkArgs(arguments,[{name:"success",type:"function",required:!0},{name:"failure",type:"function",required:!1,"default":function(){}},{name:"options",type:"object",required:!1,"default":defaultVehicleDataOptions}]);a=d[0],b=d[1],c=d[2];var e=gm.vehicle._getVehicleModelKeys(c),f=gm.vehicle._vehicle_data_watch_prefix+gm.vehicle._vehicle_data_watch_count;return Emulator.addVehicleDataWatch(f,e,gm.vehicle.getVehicleData,a,b,c),gm.vehicle._vehicle_data_watch_count++},gm.vehicle.clearVehicleData=function(a){Emulator.checkArgs(arguments,[{name:"watchID",required:!0,type:"number"}]),Emulator.destroyVehicleWatch(gm.vehicle._vehicle_data_watch_prefix+a)},gm.vehicle.getVIN=function(){return""+Emulator.getValue(GM_CONFIG.VehicleData.VIN_Digits_2_to_9.vin_2_9.model.key)+Emulator.getValue(GM_CONFIG.VehicleData.VIN_Digits_10_to_17.vin_10_17.model.key)},gm.vehicle.getVehicleConfiguration=function(a,b){var c=Emulator.checkArgs(arguments,[{name:"success",type:"function",required:!0},{name:"failure",type:"function",required:!1,"default":function(){}}]);a=c[0],b=c[1];var d={};for(var e in GM_CONFIG.VehicleConfiguration)d[e]=Emulator.getValue(e);d.input=gm.constants.vehicleConfiguration[d.input],parseFloat(d.screenSize)==GM_CONFIG.ScreenSize.SMALL?d.screenResolution={width:480,height:272}:d.screenResolution={width:802,height:482},a(d)},gm.vehicle.webServiceRequest=function(a,b,c){var d=Emulator.checkArgs(arguments,[{name:"success",type:"function",required:!0},{name:"failure",type:"function",required:!1,"default":function(){}},{name:"options",type:"object",required:!0}]);a=d[0],b=d[1],c=d[2];if(gm.hmi.getNetworkConnectivity()==0){b({error:"No active network devices"});return}var e=new XMLHttpRequest,f="";c.url.match(/:\/\//)?f=c.url:f=Emulator.getDirName()+"/"+c.url;var g;if(typeof c.method!="undefined"){var h=GM_CONFIG.Communication.REQUEST_METHODS;for(var i in h)if(c.method.toLowerCase()===h[i].toLowerCase()){g=h[i];break}}typeof g=="undefined"&&(typeof c.parameters=="undefined"?g="GET":g="POST");var j="";for(var k in c.parameters){var l=c.parameters[k];j+=encodeURIComponent(k)+"=",typeof c.parameters[k]=="object"?j+=encodeURIComponent(JSON.stringify(l))+"&":j+=encodeURIComponent(l)+"&"}j.length>0&&(j=j.slice(0,-1)),e.onreadystatechange=function(){e.readyState==4&&(e.status==200?a(e.responseText):b(GM_CONFIG.FailureCodes.COMMUNICATION_FAILURE))},g=="POST"?(e.open(g,f,!0),e.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e.send(j)):(f+=f.indexOf("?")<0?"?":"&",f+=j,e.open(g,f,!0),e.send(null))},gm.vehicle.getVersion=function(a){var b=Emulator.checkArgs(arguments,[{name:"options",type:"object",required:!1,"default":{}}]);return{version:"1.5",cluster:null,radio:null,onstar:null}},gm.vehicle.getSpeed=function(){var a=Emulator.getValue(GM_CONFIG.VehicleData.Vehicle_Speed_Information.average_speed.model.key);return a==0?GM_CONFIG.SPEEDS.PARK:a<GM_CONFIG.LOWSPEED_THRESHOLD?GM_CONFIG.SPEEDS.LOW_SPEED:GM_CONFIG.SPEEDS.HIGH_SPEED},gm.vehicle.watchSpeed=function(a,b){var c=Emulator.checkArgs(arguments,[{name:"success",type:"function",required:!0},{name:"failure",type:"function",required:!1,"default":function(){}}]);a=c[0],b=c[1],Emulator.Vehicle.speedWatchIndex++;var d=gm.vehicle.getSpeed();return Emulator.addVehicleDataWatch("VEHICLE_SPEED_WATCH_"+Emulator.Vehicle.speedWatchIndex,[GM_CONFIG.VehicleData.Vehicle_Speed_Information.average_speed.model.key],function(a){var b=gm.vehicle.getSpeed();b!=d&&(a(b),d=b)},a,b),Emulator.Vehicle.speedWatchIndex},gm.vehicle.clearSpeed=function(a){Emulator.checkArgs(arguments,[{name:"watchID",required:!0,type:"number"}]),Emulator.destroyVehicleWatch("VEHICLE_SPEED_WATCH_"+a)},gm.video={},gm.video.play=function(a,b){Emulator.checkArgs(arguments,[{name:"filename",required:!0,type:"string"},{name:"failure",required:!1,type:"function","default":function(){}}]),typeof b!="function"&&(b=function(){});var c=Emulator.mediaPlayerController.getNewVideoHandle(),d=Emulator.getRequestingApp();return Emulator.PubSub.notify(GM_CONFIG.Events.PLAY_VIDEO,{handle:c,filename:a,failure:b,appID:d}),c},gm.video.pause=function(a){Emulator.checkArgs(arguments,[{name:"videoHandle",required:!0,type:"number"}]),Emulator.PubSub.notify(GM_CONFIG.Events.PAUSE_VIDEO,{handle:a})},gm.video.stop=function(a){Emulator.checkArgs(arguments,[{name:"videoHandle",required:!0,type:"number"}]),Emulator.PubSub.notify(GM_CONFIG.Events.STOP_VIDEO,{handle:a})},gm.video.seek=function(a,b){Emulator.checkArgs(arguments,[{name:"videoHandle",required:!0,type:"number"},{name:"position",required:!0,type:"number"}]),Emulator.PubSub.notify(GM_CONFIG.Events.SEEK_VIDEO,{handle:a,position:b})}